{%- liquid
  assign heading = section.settings.heading
  assign subheading = section.settings.subheading
  assign description = section.settings.description
  assign button_text = section.settings.button_text
  assign success_message = section.settings.success_message
  assign privacy_text = section.settings.privacy_text
  assign bg_image = section.settings.background_image
  assign mobile_image = section.settings.mobile_image
  assign badge_text = section.settings.badge_text
  assign overlay_opacity = section.settings.overlay_opacity
-%}

<section class="launch-hero" id="launch-hero">
  {%- if bg_image != blank -%}
    <picture class="launch-hero__bg">
      {%- if mobile_image != blank -%}
        <source media="(max-width: 749px)" srcset="{{ mobile_image | image_url: width: 800 }}">
      {%- endif -%}
      <img
        src="{{ bg_image | image_url: width: 1920 }}"
        alt="{{ bg_image.alt | default: heading | escape }}"
        loading="eager"
        fetchpriority="high"
        class="launch-hero__bg-img"
      >
    </picture>
  {%- endif -%}

  <div class="launch-hero__overlay" style="opacity: {{ overlay_opacity | divided_by: 100.0 }};"></div>

  <div class="launch-hero__container">
    {%- if badge_text != blank -%}
      <span class="launch-hero__badge">{{ badge_text }}</span>
    {%- endif -%}

    <h1 class="launch-hero__heading">{{ heading }}</h1>

    {%- if subheading != blank -%}
      <p class="launch-hero__subheading">{{ subheading }}</p>
    {%- endif -%}

    {%- if description != blank -%}
      <p class="launch-hero__description">{{ description }}</p>
    {%- endif -%}

    <launch-email-form class="launch-hero__form-wrapper">
      {%- form 'contact', class: 'launch-hero__form', id: 'launch-hero-form' -%}
        <input type="hidden" name="contact[tags]" value="launch-waitlist,landing-page">
        <input type="hidden" name="contact[body]" value="Launch Waitlist Signup from Landing Page">

        <div class="launch-hero__form-row">
          <input
            type="email"
            name="contact[email]"
            class="launch-hero__input"
            placeholder="Enter your email"
            required
            autocomplete="email"
            aria-label="Email address"
          >
          <button type="submit" class="launch-hero__submit">
            {{ button_text | default: 'Get Early Access' }}
          </button>
        </div>

        {%- if form.posted_successfully? -%}
          <div class="launch-hero__success" data-success="true">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
              <polyline points="20 6 9 17 4 12"></polyline>
            </svg>
            <span>{{ success_message | default: "You're in! Check your inbox for your exclusive offer." }}</span>
          </div>
        {%- endif -%}

        {%- if form.errors -%}
          <p class="launch-hero__error">
            {{ form.errors.messages['email'] | default: 'Please enter a valid email.' }}
          </p>
        {%- endif -%}
      {%- endform -%}

      {%- if privacy_text != blank -%}
        <p class="launch-hero__privacy">{{ privacy_text }}</p>
      {%- endif -%}
    </launch-email-form>

    {%- if section.settings.show_counter -%}
      <div class="launch-hero__counter">
        <span class="launch-hero__counter-number">{{ section.settings.counter_number | default: '500+' }}</span>
        <span class="launch-hero__counter-label">{{ section.settings.counter_label | default: 'people already signed up' }}</span>
      </div>
    {%- endif -%}
  </div>
</section>

<script>
  class LaunchEmailForm extends HTMLElement {
    connectedCallback() {
      const success = this.querySelector('[data-success="true"]');
      if (success) {
        this.querySelector('.launch-hero__form-row')?.style.setProperty('display', 'none');
      }
    }
  }
  if (!customElements.get('launch-email-form')) {
    customElements.define('launch-email-form', LaunchEmailForm);
  }
</script>

{% stylesheet %}
  .launch-hero {
    position: relative;
    display: flex;
    align-items: center;
    justify-content: center;
    min-height: 85vh;
    overflow: hidden;
    background: var(--moby-dark, #1B1A0F);
  }

  .launch-hero__bg {
    position: absolute;
    inset: 0;
    width: 100%;
    height: 100%;
  }

  .launch-hero__bg-img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .launch-hero__overlay {
    position: absolute;
    inset: 0;
    background: var(--moby-dark, #1B1A0F);
    pointer-events: none;
  }

  .launch-hero__container {
    position: relative;
    z-index: 2;
    max-width: 640px;
    width: 100%;
    margin: 0 auto;
    padding: 80px 24px;
    text-align: center;
    display: flex;
    flex-direction: column;
    align-items: center;
  }

  .launch-hero__badge {
    display: inline-block;
    font-family: 'N27', sans-serif;
    font-size: 12px;
    font-weight: 500;
    text-transform: uppercase;
    letter-spacing: 0.12em;
    color: var(--moby-dark, #1B1A0F);
    background: var(--moby-lime, #F9FDB5);
    padding: 6px 16px;
    border-radius: 100px;
    margin-bottom: 24px;
  }

  .launch-hero__heading {
    font-family: 'Memoir', serif;
    font-size: clamp(36px, 6vw, 56px);
    font-weight: 400;
    text-transform: uppercase;
    letter-spacing: 0.02em;
    line-height: 1.05;
    color: #fff;
    margin: 0 0 16px;
  }

  .launch-hero__subheading {
    font-family: 'N27', sans-serif;
    font-size: clamp(16px, 2.5vw, 20px);
    font-weight: 400;
    line-height: 1.4;
    color: var(--moby-lime, #F9FDB5);
    margin: 0 0 12px;
    max-width: 480px;
  }

  .launch-hero__description {
    font-family: 'N27', sans-serif;
    font-size: 15px;
    font-weight: 300;
    line-height: 1.6;
    color: var(--moby-sage, #C9C8B6);
    margin: 0 0 32px;
    max-width: 440px;
  }

  .launch-hero__form-wrapper {
    width: 100%;
    max-width: 460px;
    display: block;
  }

  .launch-hero__form {
    width: 100%;
  }

  .launch-hero__form-row {
    display: flex;
    gap: 0;
    width: 100%;
    border-radius: 6px;
    overflow: hidden;
    border: 1px solid rgba(249, 253, 181, 0.3);
  }

  .launch-hero__input {
    flex: 1;
    font-family: 'N27', sans-serif;
    font-size: 15px;
    font-weight: 300;
    color: #fff;
    background: rgba(255, 255, 255, 0.08);
    border: none;
    padding: 14px 18px;
    outline: none;
    min-width: 0;
  }

  .launch-hero__input::placeholder {
    color: var(--moby-sage, #C9C8B6);
    opacity: 0.7;
  }

  .launch-hero__input:focus {
    background: rgba(255, 255, 255, 0.12);
  }

  .launch-hero__submit {
    font-family: 'N27', sans-serif;
    font-size: 14px;
    font-weight: 500;
    text-transform: uppercase;
    letter-spacing: 0.06em;
    color: var(--moby-dark, #1B1A0F);
    background: var(--moby-lime, #F9FDB5);
    border: none;
    padding: 14px 24px;
    cursor: pointer;
    white-space: nowrap;
    transition: background 0.2s ease;
  }

  .launch-hero__submit:hover {
    background: #eef2a0;
  }

  .launch-hero__success {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    font-family: 'N27', sans-serif;
    font-size: 15px;
    font-weight: 400;
    color: var(--moby-lime, #F9FDB5);
    padding: 14px;
    background: rgba(249, 253, 181, 0.1);
    border-radius: 6px;
    border: 1px solid rgba(249, 253, 181, 0.2);
  }

  .launch-hero__error {
    font-family: 'N27', sans-serif;
    font-size: 13px;
    color: #ff6b6b;
    margin-top: 8px;
  }

  .launch-hero__privacy {
    font-family: 'N27', sans-serif;
    font-size: 12px;
    font-weight: 300;
    color: var(--moby-sage, #C9C8B6);
    opacity: 0.6;
    margin: 12px 0 0;
  }

  .launch-hero__counter {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-top: 28px;
    font-family: 'N27', sans-serif;
    color: var(--moby-sage, #C9C8B6);
  }

  .launch-hero__counter-number {
    font-size: 14px;
    font-weight: 500;
    color: var(--moby-lime, #F9FDB5);
  }

  .launch-hero__counter-label {
    font-size: 13px;
    font-weight: 300;
    opacity: 0.7;
  }

  @media screen and (max-width: 749px) {
    .launch-hero {
      min-height: 75vh;
    }

    .launch-hero__container {
      padding: 60px 20px;
    }

    .launch-hero__form-row {
      flex-direction: column;
      border-radius: 6px;
    }

    .launch-hero__input {
      border-bottom: 1px solid rgba(249, 253, 181, 0.15);
      text-align: center;
    }

    .launch-hero__submit {
      padding: 14px 24px;
    }
  }
{% endstylesheet %}

{% schema %}
{
  "name": "Launch Hero",
  "tag": "section",
  "class": "launch-hero-section",
  "settings": [
    {
      "type": "image_picker",
      "id": "background_image",
      "label": "Background image"
    },
    {
      "type": "image_picker",
      "id": "mobile_image",
      "label": "Mobile background image",
      "info": "Optional. Uses desktop image if empty."
    },
    {
      "type": "range",
      "id": "overlay_opacity",
      "label": "Overlay darkness",
      "min": 0,
      "max": 90,
      "step": 5,
      "default": 45,
      "unit": "%"
    },
    {
      "type": "text",
      "id": "badge_text",
      "label": "Badge text",
      "default": "Launching Soon"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Something Big is Coming"
    },
    {
      "type": "text",
      "id": "subheading",
      "label": "Subheading",
      "default": "Get an exclusive launch discount"
    },
    {
      "type": "textarea",
      "id": "description",
      "label": "Description",
      "default": "Be the first to know when we launch and receive an exclusive discount only for early supporters."
    },
    {
      "type": "text",
      "id": "button_text",
      "label": "Button text",
      "default": "Get Early Access"
    },
    {
      "type": "text",
      "id": "success_message",
      "label": "Success message",
      "default": "You're in! Check your inbox for your exclusive offer."
    },
    {
      "type": "text",
      "id": "privacy_text",
      "label": "Privacy text",
      "default": "No spam. Unsubscribe anytime."
    },
    {
      "type": "header",
      "content": "Social proof counter"
    },
    {
      "type": "checkbox",
      "id": "show_counter",
      "label": "Show signup counter",
      "default": true
    },
    {
      "type": "text",
      "id": "counter_number",
      "label": "Counter number",
      "default": "500+"
    },
    {
      "type": "text",
      "id": "counter_label",
      "label": "Counter label",
      "default": "people already signed up"
    }
  ],
  "presets": [
    {
      "name": "Launch Hero"
    }
  ]
}
{% endschema %}
